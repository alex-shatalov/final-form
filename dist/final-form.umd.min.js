!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e["final-form"]={})}(this,function(e){"use strict";var t=function(e){if(null===e||void 0===e)return[];if("string"!=typeof e)throw new Error("toPath() expects a string");return e.length?e.split(/[.[\]]+/).filter(Boolean):[]},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},a=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},o=function(e,i){var n=t(i),a=e,o=!0,u=!1,s=void 0;try{for(var l,c=n[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;if(void 0===a||null===a||"object"!==(void 0===a?"undefined":r(a))||Array.isArray(a)&&isNaN(f))return;a=a[f]}}catch(e){u=!0,s=e}finally{try{!o&&c.return&&c.return()}finally{if(u)throw s}}return a},u=function(e,r,o){if(void 0===e||null===e)throw new Error("Cannot call setIn() with "+String(e)+" state");if(void 0===r||null===r)throw new Error("Cannot call setIn() with "+String(r)+" key");return function e(t,r,o,u){if(r>=o.length)return u;var s=o[r];if(isNaN(s)){if(void 0===t||null===t){var l=e(void 0,r+1,o,u);return void 0===l?void 0:i({},s,l)}if(Array.isArray(t))throw new Error("Cannot set a non-numeric property on an array");var c=e(t[s],r+1,o,u),f=Object.keys(t).length;if(void 0===c){if(void 0===t[s]&&0===f)return;if(void 0!==t[s]&&f<=1)return isNaN(o[r-1])?void 0:{}}return n({},t,i({},s,c))}var d=Number(s);if(void 0===t||null===t){var v=e(void 0,r+1,o,u);if(void 0===v)return;var b=[];return b[d]=v,b}if(!Array.isArray(t))throw new Error("Cannot set a numeric property on an object");var m=e(t[d],r+1,o,u),S=[].concat(a(t));return S[d]=m,S}(e,0,t(r),o)},s=Symbol("form-error"),l=Symbol("array-error"),c=function(e,t){var r=e.errors,i=e.initialValues,n=e.lastSubmittedValues,a=e.submitErrors,u=e.submitFailed,s=e.submitSucceeded,c=e.values,f=t.active,d=t.blur,v=t.change,b=t.data,m=t.focus,S=t.name,h=t.touched,y=t.visited,g=o(c,S),p=o(r,S);p&&p[l]&&(p=p[l]);var E=a&&o(a,S),O=i&&o(i,S),j=t.isEqual(O,g),w=!(!n||t.isEqual(o(n,S),g)),F=!p&&!E;return{active:f,blur:d,change:v,data:b,dirty:!j,dirtySinceLastSubmit:w,error:p,focus:m,initial:O,invalid:!F,length:Array.isArray(g)?g.length:void 0,name:S,pristine:j,submitError:E,submitFailed:u,submitSucceeded:s,touched:h,valid:F,value:g,visited:y}},f=["active","data","dirty","dirtySinceLastSubmit","error","initial","invalid","length","pristine","submitError","submitFailed","submitSucceeded","touched","valid","value","visited"],d=function(e,t){if(e===t)return!0;if("object"!==(void 0===e?"undefined":r(e))||!e||"object"!==(void 0===t?"undefined":r(t))||!t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),o=0;o<i.length;o++){var u=i[o];if(!a(u)||e[u]!==t[u])return!1}return!0};function v(e,t,r,i,n,a){var o=!1;return n.forEach(function(n){i[n]&&(e[n]=t[n],r&&(~a.indexOf(n)?d(t[n],r[n]):t[n]===r[n])||(o=!0))}),o}var b=["data"],m=function(e,t,r,i){var n={blur:e.blur,change:e.change,focus:e.focus,name:e.name};return v(n,e,t,r,f,b)||!t||i?n:void 0},S=["active","dirty","dirtySinceLastSubmit","error","errors","initialValues","invalid","pristine","submitting","submitError","submitErrors","submitFailed","submitSucceeded","touched","valid","validating","values","visited"],h=["touched","visited"],y=function(e,t,r,i){var n={};return v(n,e,t,r,S,h)||!t||i?n:void 0},g=function(e){var t=void 0,r=void 0;return function(){for(var i=arguments.length,n=Array(i),a=0;a<i;a++)n[a]=arguments[a];return t&&n.length===t.length&&!n.some(function(e,r){return!d(t[r],e)})||(t=n,r=e.apply(void 0,n)),r}},p=function(e){return!!e&&("object"===(void 0===e?"undefined":r(e))||"function"==typeof e)&&"function"==typeof e.then},E=function(e,t){return e===t},O=function(e){var t=e.active,r=e.dirtySinceLastSubmit,i=e.error,n=e.errors,a=e.initialValues,o=e.pristine,u=e.submitting,s=e.submitFailed,l=e.submitSucceeded,c=e.submitError,f=e.submitErrors,d=e.valid;return{active:t,dirty:!o,dirtySinceLastSubmit:r,error:i,errors:n,invalid:!d,initialValues:a,pristine:o,submitting:u,submitFailed:s,submitSucceeded:l,submitError:c,submitErrors:f,valid:d,validating:e.validating>0,values:e.values}};function j(e,t,r,i,n){var a=n(r,i,t,arguments.length>5&&void 0!==arguments[5]&&arguments[5]);a&&e(a)}function w(e,t,r,i){var n=e.entries;Object.keys(n).forEach(function(e){var a=n[Number(e)],o=a.subscription;j(a.subscriber,o,t,r,i)})}e.createForm=function(e){if(!e)throw new Error("No config specified");e.debug;var t=e.initialValues,r=e.mutators,i=e.onSubmit,f=e.validate,v=e.validateOnBlur,b=e.persistentSubmitErrors;if(!i)throw new Error("No onSubmit function specified");var S={subscribers:{index:0,entries:{}},fieldSubscribers:{},fields:{},formState:{dirtySinceLastSubmit:!1,errors:{},initialValues:t&&n({},t),invalid:!1,pristine:!0,submitting:!1,submitFailed:!1,submitSucceeded:!1,valid:!0,validating:0,values:t?n({},t):{}},lastFormState:void 0},h=!1,F=!1,k=!1,V=0,A={},N=function(e){return function(t){return delete A[e],t}},x=function(e,t,r){if(e.fields[t]){var i=r(o(e.formState.values,t));e.formState.values=u(e.formState.values,t,i)||{}}},R=function(e){return function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];if(r){var a={formState:S.formState,fields:S.fields},s=r[e](i,a,{changeValue:x,getIn:o,setIn:u,shallowEqual:d});return S.formState=a.formState,S.fields=a.fields,q(void 0,function(){L(),B()}),s}}},P=r&&Object.keys(r).reduce(function(e,t){return e[t]=R(t),e},{})||{},I=function(e){return Object.keys(e.validators).reduce(function(t,r){var i=e.validators[Number(r)]();return i&&t.push(i),t},[])},q=function(e,t){if(F)return k=!0,void(t&&t());var r=S.fields,i=S.formState,c=Object.keys(r);if(f||c.some(function(e){return I(r[e]).length})){var v=!1;if(e){var b=r[e].validateFields;b&&(v=!0,c=b.length?b.concat(e):[e])}var m={},h={},y=[].concat(a(function(e){var t=[];if(f){var r=f(n({},S.formState.values));if(p(r)){var i=V++,a=r.then(e).then(N(i));t.push(a),A[i]=a}else e(r)}return t}(function(e){m=e||{}})),a(c.reduce(function(e,t){return e.concat(function(e,t){var r=[],i=I(e);if(i.length){var n=void 0;i.forEach(function(i){var a=i(o(S.formState.values,e.name),S.formState.values);if(a&&p(a)){var u=V++,s=a.then(t).then(N(u));r.push(s),A[u]=s}else n||(n=a)}),t(n)}return r}(r[t],function(e){h[t]=e}))},[]))),g=function(){var e=n({},v?i.errors:{},m),t=function(t){c.forEach(function(i){if(r[i]){var n=o(m,i),a=o(e,i),u=I(r[i]).length,s=h[i];t(i,u&&s||f&&n||(n||v?void 0:a))}})};t(function(t,r){e=u(e,t,r)||{}}),t(function(t,r){if(r&&r[l]){var i=o(e,t),n=[].concat(a(i));n[l]=r[l],e=u(e,t,n)}}),d(i.errors,e)||(i.errors=e),i.error=m[s]};g(),y.length?(S.formState.validating++,t&&t(),Promise.all(y).then(function(){S.formState.validating--,g(),t&&t()})):t&&t()}else t&&t()},L=function(e){if(!h){var t=S.fields,r=S.fieldSubscribers,i=S.formState;Object.keys(t).forEach(function(e){var n=t[e],a=c(i,n),o=n.lastFieldState;d(a,o)||(n.lastFieldState=a,w(r[e],a,o,m))})}},C=function(){var e=S.fields,t=S.formState,r=S.lastFormState,i=Object.keys(e);t.pristine=i.every(function(r){return e[r].isEqual(o(t.values,r),o(t.initialValues||{},r))}),t.dirtySinceLastSubmit=!(!t.lastSubmittedValues||i.every(function(r){return e[r].isEqual(o(t.values,r),o(t.lastSubmittedValues||{},r))})),t.valid=!(t.error||t.submitError||Object.keys(t.errors).length||t.submitErrors&&Object.keys(t.submitErrors).length);var n=O(t),a=i.reduce(function(t,r){return t.touched[r]=e[r].touched,t.visited[r]=e[r].visited,t},{touched:{},visited:{}}),u=a.touched,s=a.visited;return n.touched=r&&d(r.touched,u)?r.touched:u,n.visited=r&&d(r.visited,s)?r.visited:s,r&&d(r,n)?r:n},_=!1,z=!1,B=function e(){if(_)z=!0;else{if(_=!0,!h){var t=S.lastFormState,r=C();r!==t&&(S.lastFormState=r,w(S.subscribers,r,t,y))}_=!1,z&&(z=!1,e())}};q();var M={batch:function(e){h=!0,e(),h=!1,L(),B()},blur:function(e){var t=S.fields,r=S.formState,i=t[e];i&&(delete r.active,t[e]=n({},i,{active:!1,touched:!0}),v?q(e,function(){L(),B()}):(L(),B()))},change:function(e,t){var r=S.fields,i=S.formState;r[e]&&o(i.values,e)!==t&&(x(S,e,function(){return t}),v?(L(),B()):q(e,function(){L(),B()}))},focus:function(e){var t=S.fields[e];t&&!t.active&&(S.formState.active=e,t.active=!0,t.visited=!0,L(),B())},mutators:P,getFieldState:function(e){var t=S.fields[e];return t&&t.lastFieldState},getRegisteredFields:function(){return Object.keys(S.fields)},getState:function(){return O(S.formState)},initialize:function(e){var t=S.fields,r=S.formState;r.initialValues=e,r.values=e,Object.keys(t).forEach(function(e){var r=t[e];r.touched=!1,r.visited=!1}),q(void 0,function(){L(),B()})},pauseValidation:function(){F=!0},registerField:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3];S.fieldSubscribers[e]||(S.fieldSubscribers[e]={index:0,entries:{}});var n=S.fieldSubscribers[e].index++;if(S.fieldSubscribers[e].entries[n]={subscriber:g(t),subscription:r},!S.fields[e]){var a=S.formState.initialValues?o(S.formState.initialValues,e):void 0;S.fields[e]={active:!1,blur:function(){return M.blur(e)},change:function(t){return M.change(e,t)},data:{},focus:function(){return M.focus(e)},initial:a,isEqual:i&&i.isEqual||E,lastFieldState:void 0,name:e,touched:!1,valid:!0,validateFields:i&&i.validateFields,validators:{},visited:!1}}i&&i.getValidator&&(S.fields[e].validators[n]=i.getValidator);var u=!1;return q(void 0,function(){var i;B(),u||(i=c(S.formState,S.fields[e]),j(t,r,i,void 0,m,!0),S.fields[e].lastFieldState=i,u=!0),L()}),function(){delete S.fields[e].validators[n],delete S.fieldSubscribers[e].entries[n],Object.keys(S.fieldSubscribers[e].entries).length||(delete S.fieldSubscribers[e],delete S.fields[e]),q(void 0,function(){L(),B()})}},reset:function(){S.formState.submitFailed=!1,S.formState.submitSucceeded=!1,delete S.formState.submitErrors,delete S.formState.lastSubmittedValues,M.initialize(S.formState.initialValues||{})},resumeValidation:function(){F=!1,k&&q(void 0,function(){L(),B()}),k=!1},setConfig:function(e,t){switch(e){case"debug":break;case"initialValues":M.initialize(t);break;case"mutators":r=t,t?(Object.keys(P).forEach(function(e){e in t||delete P[e]}),Object.keys(t).forEach(function(e){P[e]=R(e)})):Object.keys(P).forEach(function(e){delete P[e]});break;case"onSubmit":i=t;break;case"validate":f=t,q(void 0,function(){L(),B()});break;case"validateOnBlur":v=t;break;default:throw new Error("Unrecognised option "+e)}},submit:function(){var e=S.formState,t=S.fields;if((S.formState.error||Object.keys(S.formState.errors).length)&&!b)return Object.keys(t).forEach(function(e){t[e].touched=!0}),S.formState.submitFailed=!0,B(),void L();var r=Object.keys(A);if(r.length)Promise.all(r.reduce(function(e,t){return e.push(A[Number(t)]),e},[])).then(function(){return M.submit()});else{var a=void 0,o=!1,u=function(t){e.submitting=!1,t&&(Object.keys(t).length||Object.getOwnPropertySymbols(t).length)?(e.submitFailed=!0,e.submitSucceeded=!1,e.submitErrors=t,e.submitError=t[s]):(delete e.submitErrors,delete e.submitError,e.submitFailed=!1,e.submitSucceeded=!0),B(),L(),o=!0,a&&a()};if(e.submitting=!0,e.submitFailed=!1,e.submitSucceeded=!1,e.lastSubmittedValues=n({},e.values),3===i.length){if(i(e.values,M,u),!o)return B(),new Promise(function(e){a=e})}else{var l=i(e.values,M);if(l&&p(l))return B(),l.then(u);u(l)}}},subscribe:function(e,t){if(!e)throw new Error("No callback given.");if(!t)throw new Error("No subscription provided. What values do you want to listen to?");var r=g(e),i=S.subscribers,n=S.lastFormState,a=i.index++;i.entries[a]={subscriber:r,subscription:t};var o=C();return o!==n&&(S.lastFormState=o),j(r,t,o,o,y,!0),function(){delete i.entries[a]}}};return M},e.version="4.3.1",e.ARRAY_ERROR=l,e.FORM_ERROR=s,e.formSubscriptionItems=S,e.fieldSubscriptionItems=f,e.getIn=o,e.setIn=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=final-form.umd.min.js.map
