!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t["final-form"]={})}(this,function(t){"use strict";var e=function(t){if(null===t||void 0===t)return[];if("string"!=typeof t)throw new Error("toPath() expects a string");return t.length?t.split(/[.[\]]+/).filter(Boolean):[]},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},a=function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)},o=function(t,r){var n=e(r),a=t,o=!0,u=!1,s=void 0;try{for(var l,c=n[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var d=l.value;if(void 0===a||null===a||"object"!==(void 0===a?"undefined":i(a))||Array.isArray(a)&&isNaN(d))return;a=a[d]}}catch(t){u=!0,s=t}finally{try{!o&&c.return&&c.return()}finally{if(u)throw s}}return a},u=function(t,i,o){if(void 0===t||null===t)throw new Error("Cannot call setIn() with "+String(t)+" state");if(void 0===i||null===i)throw new Error("Cannot call setIn() with "+String(i)+" key");return function t(e,i,o,u){if(i>=o.length)return u;var s=o[i];if(isNaN(s)){if(void 0===e||null===e){var l=t(void 0,i+1,o,u);return void 0===l?void 0:r({},s,l)}if(Array.isArray(e))throw new Error("Cannot set a non-numeric property on an array");var c=t(e[s],i+1,o,u),d=Object.keys(e).length;if(void 0===c){if(void 0===e[s]&&0===d)return;if(void 0!==e[s]&&d<=1)return isNaN(o[i-1])?void 0:{}}return n({},e,r({},s,c))}var f=Number(s);if(void 0===e||null===e){var v=t(void 0,i+1,o,u);if(void 0===v)return;var b=[];return b[f]=v,b}if(!Array.isArray(e))throw new Error("Cannot set a numeric property on an object");var m=t(e[f],i+1,o,u),S=[].concat(a(e));return S[f]=m,S}(t,0,e(i),o)},s=function(t,e){var i=t.errors,r=t.initialValues,n=t.lastSubmittedValues,a=t.submitErrors,u=t.submitFailed,s=t.submitSucceeded,l=t.values,c=e.active,d=e.blur,f=e.change,v=e.data,b=e.focus,m=e.name,S=e.touched,h=e.visited,y=o(l,m),g=o(i,m),p=a&&o(a,m),E=r&&o(r,m),O=e.isEqual(E,y),j=!(!n||e.isEqual(o(n,m),y)),w=!g&&!p;return{active:c,blur:d,change:f,data:v,dirty:!O,dirtySinceLastSubmit:j,error:g,focus:b,initial:E,invalid:!w,length:Array.isArray(y)?y.length:void 0,name:m,pristine:O,submitError:p,submitFailed:u,submitSucceeded:s,touched:S,valid:w,value:y,visited:h}},l=["active","data","dirty","dirtySinceLastSubmit","error","initial","invalid","length","pristine","submitError","submitFailed","submitSucceeded","touched","valid","value","visited"],c=function(t,e){if(t===e)return!0;if("object"!==(void 0===t?"undefined":i(t))||!t||"object"!==(void 0===e?"undefined":i(e))||!e)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(e),o=0;o<r.length;o++){var u=r[o];if(!a(u)||t[u]!==e[u])return!1}return!0};function d(t,e,i,r,n,a){var o=!1;return n.forEach(function(n){r[n]&&(t[n]=e[n],i&&(~a.indexOf(n)?c(e[n],i[n]):e[n]===i[n])||(o=!0))}),o}var f=["data"],v=function(t,e,i,r){var n={blur:t.blur,change:t.change,focus:t.focus,name:t.name};return d(n,t,e,i,l,f)||!e||r?n:void 0},b=["active","dirty","dirtySinceLastSubmit","error","errors","initialValues","invalid","pristine","submitting","submitError","submitErrors","submitFailed","submitSucceeded","touched","valid","validating","values","visited"],m=["touched","visited"],S=function(t,e,i,r){var n={};return d(n,t,e,i,b,m)||!e||r?n:void 0},h=function(t){var e=void 0,i=void 0;return function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];return e&&n.length===e.length&&!n.some(function(t,i){return!c(e[i],t)})||(e=n,i=t.apply(void 0,n)),i}},y=function(t){return!!t&&("object"===(void 0===t?"undefined":i(t))||"function"==typeof t)&&"function"==typeof t.then},g=Symbol("form-error"),p=function(t,e){return t===e},E=function(t){var e=t.active,i=t.dirtySinceLastSubmit,r=t.error,n=t.errors,a=t.initialValues,o=t.pristine,u=t.submitting,s=t.submitFailed,l=t.submitSucceeded,c=t.submitError,d=t.submitErrors,f=t.valid;return{active:e,dirty:!o,dirtySinceLastSubmit:i,error:r,errors:n,invalid:!f,initialValues:a,pristine:o,submitting:u,submitFailed:s,submitSucceeded:l,submitError:c,submitErrors:d,valid:f,validating:t.validating>0,values:t.values}};function O(t,e,i,r,n){var a=n(i,r,e,arguments.length>5&&void 0!==arguments[5]&&arguments[5]);a&&t(a)}function j(t,e,i,r){var n=t.entries;Object.keys(n).forEach(function(t){var a=n[Number(t)],o=a.subscription;O(a.subscriber,o,e,i,r)})}t.createForm=function(t){if(!t)throw new Error("No config specified");t.debug;var e=t.initialValues,i=t.mutators,r=t.onSubmit,l=t.validate,d=t.validateOnBlur,f=t.persistentSubmitErrors;if(!r)throw new Error("No onSubmit function specified");var b={subscribers:{index:0,entries:{}},fieldSubscribers:{},fields:{},formState:{dirtySinceLastSubmit:!1,errors:{},initialValues:e&&n({},e),invalid:!1,pristine:!0,submitting:!1,submitFailed:!1,submitSucceeded:!1,valid:!0,validating:0,values:e?n({},e):{}},lastFormState:void 0},m=!1,w=!1,F=!1,V=function(t,e,i){if(t.fields[e]){var r=i(o(t.formState.values,e));t.formState.values=u(t.formState.values,e,r)||{}}},k=i&&Object.keys(i).reduce(function(t,e){return t[e]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var a={formState:b.formState,fields:b.fields},s=i[e](r,a,{changeValue:V,getIn:o,setIn:u,shallowEqual:c});return b.formState=a.formState,b.fields=a.fields,N(void 0,function(){x(),P()}),s},t},{})||{},A=function(t){return Object.keys(t.validators).reduce(function(e,i){var r=t.validators[Number(i)]();return r&&e.push(r),e},[])},N=function(t,e){if(w)return F=!0,void(e&&e());var i=b.fields,r=b.formState,s=Object.keys(i);if(l||s.some(function(t){return A(i[t]).length})){if(t){var d=i[t].validateFields;d&&(s=d.length?d.concat(t):[t])}var f={},v={},m=[].concat(a(function(t){var e=[];if(l){var i=l(n({},b.formState.values));y(i)?e.push(i.then(t)):t(i)}return e}(function(t){f=t||{}})),a(s.reduce(function(t,e){return t.concat(function(t,e){var i=[],r=A(t);if(r.length){var n=void 0;r.forEach(function(r){var a=r(o(b.formState.values,t.name),b.formState.values);a&&y(a)?i.push(a.then(e)):n||(n=a)}),e(n)}return i}(i[e],function(t){v[e]=t}))},[]))),S=function(){var t=n({},f);s.forEach(function(e){if(i[e]){var r=v[e]||o(f,e);r&&(t=u(t,e,r))}}),c(r.errors,t)||(r.errors=t),r.error=f[g]};S(),m.length?(b.formState.validating++,e&&e(),Promise.all(m).then(function(){b.formState.validating--,S(),e&&e()})):e&&e()}else e&&e()},x=function(t){if(!m){var e=b.fields,i=b.fieldSubscribers,r=b.formState;Object.keys(e).forEach(function(t){var n=e[t],a=s(r,n),o=n.lastFieldState;c(a,o)||(n.lastFieldState=a,j(i[t],a,o,v))})}},I=function(){var t=b.fields,e=b.formState,i=b.lastFormState,r=Object.keys(t);e.pristine=r.every(function(i){return t[i].isEqual(o(e.values,i),o(e.initialValues||{},i))}),e.dirtySinceLastSubmit=!(!e.lastSubmittedValues||r.every(function(i){return t[i].isEqual(o(e.values,i),o(e.lastSubmittedValues||{},i))})),e.valid=!(e.error||e.submitError||Object.keys(e.errors).length||e.submitErrors&&Object.keys(e.submitErrors).length);var n=E(e),a=r.reduce(function(e,i){return e.touched[i]=t[i].touched,e.visited[i]=t[i].visited,e},{touched:{},visited:{}}),u=a.touched,s=a.visited;return n.touched=i&&c(i.touched,u)?i.touched:u,n.visited=i&&c(i.visited,s)?i.visited:s,i&&c(i,n)?i:n},P=function(){if(!m){var t=b.lastFormState,e=I();e!==t&&(b.lastFormState=e,j(b.subscribers,e,t,S))}};N();var q={batch:function(t){m=!0,t(),m=!1,x(),P()},blur:function(t){var e=b.fields,i=b.formState,r=e[t];r&&(delete i.active,e[t]=n({},r,{active:!1,touched:!0}),d?N(t,function(){x(),P()}):(x(),P()))},change:function(t,e){var i=b.fields,r=b.formState;i[t]&&o(r.values,t)!==e&&(V(b,t,function(){return e}),d?(x(),P()):N(t,function(){x(),P()}))},focus:function(t){var e=b.fields[t];e&&!e.active&&(b.formState.active=t,e.active=!0,e.visited=!0,x(),P())},mutators:k,getRegisteredFields:function(){return Object.keys(b.fields)},getState:function(){return E(b.formState)},initialize:function(t){var e=b.fields,i=b.formState;i.initialValues=t,i.values=t,Object.keys(e).forEach(function(t){var i=e[t];i.touched=!1,i.visited=!1}),N(void 0,function(){x(),P()})},pauseValidation:function(){w=!0},registerField:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3];b.fieldSubscribers[t]||(b.fieldSubscribers[t]={index:0,entries:{}});var n=b.fieldSubscribers[t].index++;if(b.fieldSubscribers[t].entries[n]={subscriber:h(e),subscription:i},!b.fields[t]){var a=b.formState.initialValues?o(b.formState.initialValues,t):void 0;b.fields[t]={active:!1,blur:function(){return q.blur(t)},change:function(e){return q.change(t,e)},data:{},focus:function(){return q.focus(t)},initial:a,isEqual:r&&r.isEqual||p,lastFieldState:void 0,name:t,touched:!1,valid:!0,validateFields:r&&r.validateFields,validators:{},visited:!1}}r&&r.getValidator&&(b.fields[t].validators[n]=r.getValidator);var u=!1;return N(void 0,function(){var r;P(),u||(r=s(b.formState,b.fields[t]),O(e,i,r,void 0,v,!0),b.fields[t].lastFieldState=r,u=!0),x()}),function(){delete b.fields[t].validators[n],delete b.fieldSubscribers[t].entries[n],Object.keys(b.fieldSubscribers[t].entries).length||(delete b.fieldSubscribers[t],delete b.fields[t]),N(void 0,function(){x(),P()})}},reset:function(){q.initialize(b.formState.initialValues||{})},resumeValidation:function(){w=!1,F&&N(void 0,function(){x(),P()}),F=!1},submit:function(){var t=b.formState,e=b.fields;if((b.formState.error||Object.keys(b.formState.errors).length)&&!f)return Object.keys(e).forEach(function(t){e[t].touched=!0}),b.formState.submitFailed=!0,P(),void x();var i=void 0,a=!1,o=function(e){t.submitting=!1,e&&(Object.keys(e).length||Object.getOwnPropertySymbols(e).length)?(t.submitFailed=!0,t.submitSucceeded=!1,t.submitErrors=e,t.submitError=e[g]):(delete t.submitErrors,delete t.submitError,t.submitFailed=!1,t.submitSucceeded=!0),P(),x(),a=!0,i&&i()};if(t.submitting=!0,t.submitFailed=!1,t.submitSucceeded=!1,t.lastSubmittedValues=n({},t.values),3===r.length){if(r(t.values,q,o),!a)return P(),new Promise(function(t){i=t})}else{var u=r(t.values,q);if(u&&y(u))return P(),u.then(o);o(u)}},subscribe:function(t,e){if(!t)throw new Error("No callback given.");if(!e)throw new Error("No subscription provided. What values do you want to listen to?");var i=h(t),r=b.subscribers,n=b.lastFormState,a=r.index++;r.entries[a]={subscriber:i,subscription:e};var o=I();return o!==n&&(b.lastFormState=o),O(i,e,o,o,S,!0),function(){delete r.entries[a]}}};return q},t.FORM_ERROR=g,t.version="4.2.0",t.formSubscriptionItems=b,t.fieldSubscriptionItems=l,t.getIn=o,t.setIn=u,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=final-form.umd.min.js.map
