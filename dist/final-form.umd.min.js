!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e["final-form"]={})}(this,function(e){"use strict";var t=function(e){if(null===e||void 0===e)return[];if("string"!=typeof e)throw new Error("toPath() expects a string");return e.length?e.split(/[.[\]]+/).filter(Boolean):[]},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},a=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)},o=function(e,r){var n=t(r),a=e,o=!0,u=!1,s=void 0;try{for(var l,c=n[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;if(void 0===a||null===a||"object"!==(void 0===a?"undefined":i(a))||Array.isArray(a)&&isNaN(f))return;a=a[f]}}catch(e){u=!0,s=e}finally{try{!o&&c.return&&c.return()}finally{if(u)throw s}}return a},u=function(e,i,o){if(void 0===e||null===e)throw new Error("Cannot call setIn() with "+String(e)+" state");if(void 0===i||null===i)throw new Error("Cannot call setIn() with "+String(i)+" key");return function e(t,i,o,u){if(i>=o.length)return u;var s=o[i];if(isNaN(s)){if(void 0===t||null===t){var l=e(void 0,i+1,o,u);return void 0===l?void 0:r({},s,l)}if(Array.isArray(t))throw new Error("Cannot set a non-numeric property on an array");var c=e(t[s],i+1,o,u),f=Object.keys(t).length;if(void 0===c){if(void 0===t[s]&&0===f)return;if(void 0!==t[s]&&f<=1)return isNaN(o[i-1])?void 0:{}}return n({},t,r({},s,c))}var d=Number(s);if(void 0===t||null===t){var v=e(void 0,i+1,o,u);if(void 0===v)return;var b=[];return b[d]=v,b}if(!Array.isArray(t))throw new Error("Cannot set a numeric property on an object");var m=e(t[d],i+1,o,u),S=[].concat(a(t));return S[d]=m,S}(e,0,t(i),o)},s=function(e,t){var i=e.errors,r=e.initialValues,n=e.lastSubmittedValues,a=e.submitErrors,u=e.submitFailed,s=e.submitSucceeded,l=e.values,c=t.active,f=t.blur,d=t.change,v=t.data,b=t.focus,m=t.name,S=t.touched,h=t.visited,y=o(l,m),g=o(i,m),p=a&&o(a,m),E=r&&o(r,m),O=t.isEqual(E,y),j=!(!n||t.isEqual(o(n,m),y)),w=!g&&!p;return{active:c,blur:f,change:d,data:v,dirty:!O,dirtySinceLastSubmit:j,error:g,focus:b,initial:E,invalid:!w,length:Array.isArray(y)?y.length:void 0,name:m,pristine:O,submitError:p,submitFailed:u,submitSucceeded:s,touched:S,valid:w,value:y,visited:h}},l=["active","data","dirty","dirtySinceLastSubmit","error","initial","invalid","length","pristine","submitError","submitFailed","submitSucceeded","touched","valid","value","visited"],c=function(e,t){if(e===t)return!0;if("object"!==(void 0===e?"undefined":i(e))||!e||"object"!==(void 0===t?"undefined":i(t))||!t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),o=0;o<r.length;o++){var u=r[o];if(!a(u)||e[u]!==t[u])return!1}return!0};function f(e,t,i,r,n,a){var o=!1;return n.forEach(function(n){r[n]&&(e[n]=t[n],i&&(~a.indexOf(n)?c(t[n],i[n]):t[n]===i[n])||(o=!0))}),o}var d=["data"],v=function(e,t,i,r){var n={blur:e.blur,change:e.change,focus:e.focus,name:e.name};return f(n,e,t,i,l,d)||!t||r?n:void 0},b=["active","dirty","dirtySinceLastSubmit","error","errors","initialValues","invalid","pristine","submitting","submitError","submitErrors","submitFailed","submitSucceeded","touched","valid","validating","values","visited"],m=["touched","visited"],S=function(e,t,i,r){var n={};return f(n,e,t,i,b,m)||!t||r?n:void 0},h=function(e){var t=void 0,i=void 0;return function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];return t&&n.length===t.length&&!n.some(function(e,i){return!c(t[i],e)})||(t=n,i=e.apply(void 0,n)),i}},y=function(e){return!!e&&("object"===(void 0===e?"undefined":i(e))||"function"==typeof e)&&"function"==typeof e.then},g=Symbol("form-error"),p=function(e,t){return e===t},E=function(e){var t=e.active,i=e.dirtySinceLastSubmit,r=e.error,n=e.errors,a=e.initialValues,o=e.pristine,u=e.submitting,s=e.submitFailed,l=e.submitSucceeded,c=e.submitError,f=e.submitErrors,d=e.valid;return{active:t,dirty:!o,dirtySinceLastSubmit:i,error:r,errors:n,invalid:!d,initialValues:a,pristine:o,submitting:u,submitFailed:s,submitSucceeded:l,submitError:c,submitErrors:f,valid:d,validating:e.validating>0,values:e.values}};function O(e,t,i,r,n){var a=n(i,r,t,arguments.length>5&&void 0!==arguments[5]&&arguments[5]);a&&e(a)}function j(e,t,i,r){var n=e.entries;Object.keys(n).forEach(function(e){var a=n[Number(e)],o=a.subscription;O(a.subscriber,o,t,i,r)})}e.createForm=function(e){if(!e)throw new Error("No config specified");e.debug;var t=e.initialValues,i=e.mutators,r=e.onSubmit,l=e.validate,f=e.validateOnBlur,d=e.persistentSubmitErrors;if(!r)throw new Error("No onSubmit function specified");var b={subscribers:{index:0,entries:{}},fieldSubscribers:{},fields:{},formState:{dirtySinceLastSubmit:!1,errors:{},initialValues:t&&n({},t),invalid:!1,pristine:!0,submitting:!1,submitFailed:!1,submitSucceeded:!1,valid:!0,validating:0,values:t?n({},t):{}},lastFormState:void 0},m=!1,w=!1,k=!1,F=0,V={},A=function(e){return function(t){return delete V[e],t}},N=function(e,t,i){if(e.fields[t]){var r=i(o(e.formState.values,t));e.formState.values=u(e.formState.values,t,r)||{}}},x=function(e){return function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(i){var a={formState:b.formState,fields:b.fields},s=i[e](r,a,{changeValue:N,getIn:o,setIn:u,shallowEqual:c});return b.formState=a.formState,b.fields=a.fields,q(void 0,function(){L(),B()}),s}}},P=i&&Object.keys(i).reduce(function(e,t){return e[t]=x(t),e},{})||{},I=function(e){return Object.keys(e.validators).reduce(function(t,i){var r=e.validators[Number(i)]();return r&&t.push(r),t},[])},q=function(e,t){if(w)return k=!0,void(t&&t());var i=b.fields,r=b.formState,s=Object.keys(i);if(l||s.some(function(e){return I(i[e]).length})){if(e){var f=i[e].validateFields;f&&(s=f.length?f.concat(e):[e])}var d={},v={},m=[].concat(a(function(e){var t=[];if(l){var i=l(n({},b.formState.values));if(y(i)){var r=F++,a=i.then(e).then(A(r));t.push(a),V[r]=a}else e(i)}return t}(function(e){d=e||{}})),a(s.reduce(function(e,t){return e.concat(function(e,t){var i=[],r=I(e);if(r.length){var n=void 0;r.forEach(function(r){var a=r(o(b.formState.values,e.name),b.formState.values);if(a&&y(a)){var u=F++,s=a.then(t).then(A(u));i.push(s),V[u]=s}else n||(n=a)}),t(n)}return i}(i[t],function(e){v[t]=e}))},[]))),S=function(){var e=n({},d);s.forEach(function(t){if(i[t]){var r=v[t]||o(d,t);r&&(e=u(e,t,r))}}),c(r.errors,e)||(r.errors=e),r.error=d[g]};S(),m.length?(b.formState.validating++,t&&t(),Promise.all(m).then(function(){b.formState.validating--,S(),t&&t()})):t&&t()}else t&&t()},L=function(e){if(!m){var t=b.fields,i=b.fieldSubscribers,r=b.formState;Object.keys(t).forEach(function(e){var n=t[e],a=s(r,n),o=n.lastFieldState;c(a,o)||(n.lastFieldState=a,j(i[e],a,o,v))})}},C=function(){var e=b.fields,t=b.formState,i=b.lastFormState,r=Object.keys(e);t.pristine=r.every(function(i){return e[i].isEqual(o(t.values,i),o(t.initialValues||{},i))}),t.dirtySinceLastSubmit=!(!t.lastSubmittedValues||r.every(function(i){return e[i].isEqual(o(t.values,i),o(t.lastSubmittedValues||{},i))})),t.valid=!(t.error||t.submitError||Object.keys(t.errors).length||t.submitErrors&&Object.keys(t.submitErrors).length);var n=E(t),a=r.reduce(function(t,i){return t.touched[i]=e[i].touched,t.visited[i]=e[i].visited,t},{touched:{},visited:{}}),u=a.touched,s=a.visited;return n.touched=i&&c(i.touched,u)?i.touched:u,n.visited=i&&c(i.visited,s)?i.visited:s,i&&c(i,n)?i:n},R=!1,z=!1,B=function e(){if(R)z=!0;else{if(R=!0,!m){var t=b.lastFormState,i=C();i!==t&&(b.lastFormState=i,j(b.subscribers,i,t,S))}R=!1,z&&(z=!1,e())}};q();var _={batch:function(e){m=!0,e(),m=!1,L(),B()},blur:function(e){var t=b.fields,i=b.formState,r=t[e];r&&(delete i.active,t[e]=n({},r,{active:!1,touched:!0}),f?q(e,function(){L(),B()}):(L(),B()))},change:function(e,t){var i=b.fields,r=b.formState;i[e]&&o(r.values,e)!==t&&(N(b,e,function(){return t}),f?(L(),B()):q(e,function(){L(),B()}))},focus:function(e){var t=b.fields[e];t&&!t.active&&(b.formState.active=e,t.active=!0,t.visited=!0,L(),B())},mutators:P,getRegisteredFields:function(){return Object.keys(b.fields)},getState:function(){return E(b.formState)},initialize:function(e){var t=b.fields,i=b.formState;i.initialValues=e,i.values=e,Object.keys(t).forEach(function(e){var i=t[e];i.touched=!1,i.visited=!1}),q(void 0,function(){L(),B()})},pauseValidation:function(){w=!0},registerField:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3];b.fieldSubscribers[e]||(b.fieldSubscribers[e]={index:0,entries:{}});var n=b.fieldSubscribers[e].index++;if(b.fieldSubscribers[e].entries[n]={subscriber:h(t),subscription:i},!b.fields[e]){var a=b.formState.initialValues?o(b.formState.initialValues,e):void 0;b.fields[e]={active:!1,blur:function(){return _.blur(e)},change:function(t){return _.change(e,t)},data:{},focus:function(){return _.focus(e)},initial:a,isEqual:r&&r.isEqual||p,lastFieldState:void 0,name:e,touched:!1,valid:!0,validateFields:r&&r.validateFields,validators:{},visited:!1}}r&&r.getValidator&&(b.fields[e].validators[n]=r.getValidator);var u=!1;return q(void 0,function(){var r;B(),u||(r=s(b.formState,b.fields[e]),O(t,i,r,void 0,v,!0),b.fields[e].lastFieldState=r,u=!0),L()}),function(){delete b.fields[e].validators[n],delete b.fieldSubscribers[e].entries[n],Object.keys(b.fieldSubscribers[e].entries).length||(delete b.fieldSubscribers[e],delete b.fields[e]),q(void 0,function(){L(),B()})}},reset:function(){b.formState.submitFailed=!1,b.formState.submitSucceeded=!1,delete b.formState.submitErrors,delete b.formState.lastSubmittedValues,_.initialize(b.formState.initialValues||{})},resumeValidation:function(){w=!1,k&&q(void 0,function(){L(),B()}),k=!1},setConfig:function(e,t){switch(e){case"debug":break;case"initialValues":_.initialize(t);break;case"mutators":i=t,t?(Object.keys(P).forEach(function(e){e in t||delete P[e]}),Object.keys(t).forEach(function(e){P[e]=x(e)})):Object.keys(P).forEach(function(e){delete P[e]});break;case"onSubmit":r=t;break;case"validate":l=t,q(void 0,function(){L(),B()});break;case"validateOnBlur":f=t;break;default:throw new Error("Unrecognised option "+e)}},submit:function(){var e=b.formState,t=b.fields;if((b.formState.error||Object.keys(b.formState.errors).length)&&!d)return Object.keys(t).forEach(function(e){t[e].touched=!0}),b.formState.submitFailed=!0,B(),void L();var i=Object.keys(V);if(i.length)Promise.all(i.reduce(function(e,t){return e.push(V[Number(t)]),e},[])).then(function(){return _.submit()});else{var a=void 0,o=!1,u=function(t){e.submitting=!1,t&&(Object.keys(t).length||Object.getOwnPropertySymbols(t).length)?(e.submitFailed=!0,e.submitSucceeded=!1,e.submitErrors=t,e.submitError=t[g]):(delete e.submitErrors,delete e.submitError,e.submitFailed=!1,e.submitSucceeded=!0),B(),L(),o=!0,a&&a()};if(e.submitting=!0,e.submitFailed=!1,e.submitSucceeded=!1,e.lastSubmittedValues=n({},e.values),3===r.length){if(r(e.values,_,u),!o)return B(),new Promise(function(e){a=e})}else{var s=r(e.values,_);if(s&&y(s))return B(),s.then(u);u(s)}}},subscribe:function(e,t){if(!e)throw new Error("No callback given.");if(!t)throw new Error("No subscription provided. What values do you want to listen to?");var i=h(e),r=b.subscribers,n=b.lastFormState,a=r.index++;r.entries[a]={subscriber:i,subscription:t};var o=C();return o!==n&&(b.lastFormState=o),O(i,t,o,o,S,!0),function(){delete r.entries[a]}}};return _},e.FORM_ERROR=g,e.version="4.3.1",e.formSubscriptionItems=b,e.fieldSubscriptionItems=l,e.getIn=o,e.setIn=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=final-form.umd.min.js.map
